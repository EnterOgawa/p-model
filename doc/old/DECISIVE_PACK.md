# 決定的検証パック（Phase 7）: 判定可能にするための手順

目的：
- 「P-modelが正しい/間違い」を断言するのではなく、**第三者が同じ手順で判定できる**状態（一次ソース＋不確かさ＋反証条件）を作る。
- “決定的”＝**Fit（調整）と Predict（外挿）を分離**し、観測が増えた時に結論がブレない運用へ固定すること。

前提（このリポジトリの統一規約）：
- 質量近傍で `P>P0`
- 重力は「P勾配へ滑り落ちる」：`a = c^2 ∇ln(P/P0)`
- 光は高P側へ屈折：`n(P)=(P/P0)^(2β)`（係数2は `β` が担う）

参照：
- ロードマップ全体：`doc/ROADMAP.md`
- 現在地/最新値：`doc/STATUS.md`
- 次の作業手順：`doc/NEXT_STEPS.md`

---

## 入口（再現コマンド）

1) 検証の一括再生成（推奨）
- `python -B scripts/summary/run_all.py --offline`

2) 論文HTML（publish）の決定版ビルド
- `python -B scripts/summary/paper_build.py --mode publish`

3) 参照する成果物（読み物）
- 一般向け統一レポート：`output/summary/pmodel_public_report.html`
- 論文HTML（publish）：`output/summary/pmodel_paper.html`

---

## Step 7.1：グローバルパラメータの凍結（β/δ）

やること：
- **β**：強い拘束のある一次データ（例：Cassini 等）で Fit して固定する。
- **δ**：高γ観測と矛盾しない上限として固定する（“測定”ではなく“制約”）。

出口条件：
- `doc/STATUS.md` に「採用β/δ」「採用根拠（一次ソース/拘束）」が固定される。
- 再現用の凍結ファイル（機械可読）が生成される：
  - `output/theory/frozen_parameters.json`

---

## Step 7.2：外挿（Predict）で“必須セット”を増やす

方針：
- Step 7.1 で β/δ を凍結したら、以後は **同じβ/δのまま**他テーマへ外挿する。
- 各テーマで「入力（一次ソース）→処理→指標→図→注意」を同じ形式に揃える。

最低限の必須セット（優先順）：
1) 重力赤方偏移（観測 vs 予測、誤差棒つき）
2) 光偏向（PPN γ：VLBIなど、観測 γ±σ を一次ソースで固定）
3) 既存検証（LLR / Viking / Mercury / GPS / EHT）を β固定で再評価

出口条件：
- `output/summary/pmodel_public_report.html` に、観測/標準理論/モデル予測が同じルールで並ぶ。
- 総合スコアボード（全検証の現状）が生成される（OK/要改善/不一致の色分け）：
  - `output/summary/validation_scoreboard.png`
  - `output/summary/validation_scoreboard.json`
  - 注：fit/predict 分離の「決定的スコアボード（β固定）」は混乱防止のためレポート掲載を停止（必要なら `scripts/summary/decisive_scoreboard.py` で単体生成）

---

## Step 7.3：反証条件（差が出る観測量）を1〜2本に絞る

狙い：
- “合う”だけでは決定打になりにくいので、**差が出る量**を選び、必要精度と棄却条件を明文化する。

候補（現状）：
- EHT：影直径係数の差（数%）＋ κ（リング/シャドウ比）とKerrスピン依存を系統として扱い、判別に必要な精度を提示。
- 速度飽和δ：現実的に測るには極端に高γ領域が必要で、現状は「矛盾しない上限」の整理が中心。

出口条件：
- 論文（publish）に「判別条件（反証可能性）」が明記され、第三者が検証に着手できる。

---

## Step 7.4：独立再現（オフライン再現）

やること：
- Web取得が必要なデータは `data/` に固定し、以後は `--offline` で再現できるようにする。
- 生成物（図/CSV/JSON）のファイル名は固定し、差し替え運用にする。

出口条件：
- 別環境でも主要図表が再生成できる（少なくとも主要指標が一致する）。
