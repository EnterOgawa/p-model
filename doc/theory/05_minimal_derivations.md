# MINIMAL DERIVATIONS (Phase 1)
ASCII preamble to avoid a known Windows tool unicode slicing issue.
Japanese content begins after this preamble.

# Phase 1：最小導出（光の屈折 / Shapiro遅延 / ニュートン極限）

目的：Phase 0（`doc/theory/04_postulates_and_dictionary.md`）で固定した定義から、
検証側（GPS/Cassini等）が参照する“結論形”がどう出るかを、最短の流れでつなぐ。

---

## 1. 前提（ここで使う定義だけ）

### 1.1 P と φ
```
φ ≡ -c^2 ln(P/P0)
```
点質量 `M`（弱場・静的）では
```
φ(r) = -GM/r
P(r)/P0 = exp(GM/(c^2 r))
```

### 1.2 光：高P側へ屈折
光（自由波）の実効屈折率を
```
n(P) = (P/P0)^(2β)   （β>0）
c_eff(P) = c / n(P)
```
と置き、光路はフェルマー（光学経路長の停留）
```
T = (1/c) ∫ n(P(x)) ds
```
で決まる（結果として高P側へ曲がる）。

弱場で `GM/(c^2 r) << 1` なら
```
n(r) = exp(2β GM/(c^2 r)) ≈ 1 + 2β GM/(c^2 r)
```

---

## 2. 光路が高P側へ曲がる（屈折）

フェルマーは「光学経路長 `∫ n ds` を停留させる経路」が実現する、という主張。
等方媒質（スカラー `n(x)`）の変分から、光線（ray）は次の形で書ける：
```
d/ds ( n * t ) = ∇n      （t = dr/ds：接線ベクトル）
```
直感的には：
- `∇n` がある（= `n` が空間で変わる）と光線は曲がる
- このモデルでは `P↑ -> n↑`（β>0）なので、質量近傍は **高n（高P）**
- よって `∇n` は概ね質量方向を向き、光路は **高P側へ屈折**する

（ここでいう「最短」は幾何学距離ではなく、`∫ n ds`（到達時間）の意味）

補足：弱場近似 `n(r) ≈ 1 + A/r`（`A = 2β GM/c^2`）なら、直線近似した積分から
```
偏向角 α ≈ 2A/b = 4β GM/(c^2 b)
```
（`b` はインパクトパラメータ）。`β=1` でGRの係数に一致する。

---

## 3. Shapiro遅延が対数（ln）形になる

光の伝播時間は
```
t = (1/c) ∫ n(r) ds
```
で、平坦時刻 `t0 = (1/c)∫ ds` との差が遅延：
```
Δt = t - t0 = (1/c) ∫ (n(r)-1) ds
```

弱場で `n(r) ≈ 1 + 2β GM/(c^2 r)` を用いると
```
Δt ≈ (2β GM/c^3) ∫ (ds/r)
```

注意（混乱防止）：
- Shapiro遅延で現れる係数は **光伝播側 `n(P)=(P/P0)^(2β)` の `2β` 由来**で、PPN対応では `(1+γ)=2β`。GR（`γ=1`）なら `β=1` で係数2が再現される。
- 係数2を合わせるために `φ=-c^2 ln(sqrt(P/P0))` のように **`φ` の定義側へ √ を入れて吸収しない**（`φ=-c^2 ln(P/P0)` を固定し、必要なら `β` を微調整する）。

ここで、光路を直線近似し、中心からの最近接距離を `b` とすると
`r = sqrt(b^2 + s^2)` となり
```
∫ (ds/r) = ln( (r1 + r2 + R)/(r1 + r2 - R) )
```
（`r1, r2` は両端点の中心からの距離、`R` は端点間距離）。

したがって（片道）：
```
Δt_oneway ≈ (2β GM/c^3) ln( (r1 + r2 + R)/(r1 + r2 - R) )
```

会合（b近似）ではよく
```
Δt_oneway ≈ (2β GM/c^3) ln( 4 r1 r2 / b^2 )
```
と書け、往復（ラウンドトリップ）はその2倍：
```
Δt_roundtrip ≈ (4β GM/c^3) ln( 4 r1 r2 / b^2 )
```

これが Cassini/Viking 等で使う “対数形” の原型になる。

---

## 3.5 Doppler y(t) (Cassini observable)

Cassiniの観測量（ドップラー）`y` は「往復遅延 `Δt_roundtrip` の時間変化率」として定義される：
```
y = - d(Δt_roundtrip)/dt
```

b近似（`ln(4 r1 r2 / b^2)` の形）を使い、最小構成（`r-dot` 項などを無視した Eq(2) 型）では
```
y ≈ (8β GM/c^3) * (b_dot/b)
```

PPN対応 `(1+γ)=2β` を使うと、標準形の係数に一致する：
```
y ≈ 4(1+γ) GM/c^3 * (b_dot/b)
```

## 4. 重力がニュートン極限に落ちる

Phase 0 の定義
```
φ ≡ -c^2 ln(P/P0)
a = -∇φ = c^2 ∇ln(P/P0)
```
を採ると、点質量 `M` で `φ(r)=-GM/r` なので
```
a(r) = -∇(-GM/r) = -GM/r^2 * r_hat
```
となり、巨視的にはニュートン重力そのものになる。

（P-modelの言い換え：質量近傍で `P` が増え、その `P` 勾配へ“滑り落ちる”のが重力。）

---

## 5. 時計（重力項 + 速度項）

Phase 0 の辞書で、時計（固有時）の進みを
```
dτ/dt = (P0/P) * (dτ/dt)_v
```
と分解して扱う。

### 5.1 静止時計（重力項）

静止（`v=0`）のとき、重力項は
```
(dτ/dt)_g = P0/P = exp(φ/c^2)
```

点質量 `M`（`φ=-GM/r`）なら
```
(dτ/dt)_g = exp(-GM/(c^2 r)) ≈ 1 - GM/(c^2 r)
```
となり、弱場近似ではGRの重力赤方偏移（`Δf/f ≈ Δφ/c^2`）と同じ一次の形になる。

### 5.2 速度項（SR相当、飽和δ）

速度項（結論形）を
```
(dτ/dt)_v = sqrt( (1 - v^2/c^2 + δ) / (1 + δ) )
```
と置く。

よって全体は
```
dτ/dt = exp(φ/c^2) * sqrt( (1 - v^2/c^2 + δ) / (1 + δ) )
```

（GPSなどの比較では、観測時刻 `t` に対して `dτ/dt - 1` を積分し、バイアス＋ドリフトを除去して残差で評価する。）

---

## 6. 速度による時間遅れ（飽和：δ）

このプロジェクトでは「波の特性として無限大（100%）は現実に出ない」という立場を取り、
速度（SR相当）の時間遅れは `v→c` で発散せず **飽和**すると置く（定義は Phase 0 の辞書に従う）。

速度項（結論形）を
```
(dτ/dt)_v = sqrt( (1 - v^2/c^2 + δ) / (1 + δ) )
```
と置くと、`v→c` の極限で
```
dτ/dt -> sqrt( δ/(1+δ) )
γ_max = dt/dτ -> sqrt((1+δ)/δ) ≈ 1/sqrt(δ)
```
となり、SRのような発散は生じない。

注意：`δ` は普遍定数だが、既存の高エネルギー観測と矛盾しないために **極小**である必要がある。
運用上の暫定採用値（余裕を見た安全側）：`δ = 1e-60`（`γ_max ~ 1e30`）。
