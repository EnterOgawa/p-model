# Step 7.3：量子もつれの再解釈（非局所仮定を用いない）

目的：
- “もつれ” を **非局所作用**の主張に直結させず、観測手続き（time-tag・選別）と局所的な時間構造（P の変調）で説明可能な範囲を切り分ける。
- Step 7.4（ベル不等式）で検証する対象を、曖昧な哲学論争ではなく **再解析可能な統計量**へ落とす。

参照（前段）：
- Step 7.1：粒子＝束縛波（反射/境界条件）`doc/quantum/01_particle_as_reflection.md`
- Step 7.2：局所モデル（出力＋time-tag＋同時計数選別）`doc/quantum/02_local_p_correlation.md`
- ブリーフ：`doc/quantum/P-model_BellTest_AI_Brief.md`

---

## 1. 本Stepの立場（何を主張し、何を未主張にするか）

本Stepは次を **未主張**とする（現段階での誤解防止）。

- 量子状態（波動関数）や Born 則の導出
- 量子場（演算子）やスピンの再現
- 既存のベル実験が「誤っている」という結論

本Stepで固定するのは、次の形の **代替説明の候補**である。

- ベル不等式が想定する「同一母集団平均」が、実験で使われる **time-tag に基づく同時計数選別**により破れ得る。
- その破れは “非局所” を仮定しなくても、局所の時間構造（装置遅延・検出応答）と結びつけば起こり得る。
- したがって “ベル違反＝非局所性の直接証拠” という解釈は、少なくとも **観測手続きの前提検証**を経てから採否を決めるべきである。

この主張は、Step 7.4 の一次データ再解析で **反証可能**な形に落とす。

---

## 2. “もつれ” を操作的に言い換える

標準量子論では、もつれは「複合系の状態が部分系の直積に分解できない」こととして定義される。
しかし本プロジェクトの焦点は、形式論ではなく **観測される相関**である。

そこで本Stepでは、もつれを次の操作的な言葉へ落とす：

- 2地点の測定出力（±1）の相関が、単純な独立ノイズや古典的混合で説明しにくい。
- 実験ではペアの対応付け（pairing）が time-tag を使って行われることが多い。

このとき、相関の推定は **「どのペアを採用するか」**に依存し得る。
もし採用集合が測定設定（a,b）に依存して変わるなら、相関の推定量そのものが “設定で異なる母集団” を見ている可能性がある。

---

## 3. P-model 側の再解釈（非局所なし）

P-model の立場で “もつれに見える相関” を説明しようとするなら、少なくとも次の構造が必要になる。

1) **共通原因（source）**  
ペア生成時に共有される内部パラメータ（λ）や、局所に伝播する共通の構造（準備された P の局所構造）を持つ。

2) **局所の装置遅延（detector timing）**  
検出時刻は、装置の光路差・電気遅延・検出器応答などの “局所時間構造” を通って決まる。
P-model では、ここに時間波密度 P が入る可能性を許す（装置条件×P で time-tag が変調され得る）。

3) **選別（post-selection）**  
実験の相関は、しばしば `|t_A-t_B|<Δt` のような同時計数条件で抽出される。
time-tag 分布が設定（a,b）で変わると、採用集合が (a,b) ごとに異なる。

この 1–3 が揃うと、ベル不等式が暗黙に置く「同一母集団平均」の仮定が崩れ得る。

重要：これは “非局所通信” を仮定しない。必要なのは **局所の遅延構造**と **選別**である。

### 3.1 数式化（共通原因 λ と selection 重み）

「共通生成過程に由来する P 構造の相関」は、局所モデルの言葉では
ペア生成時に共有される隠れ変数（もしくは共有初期条件）`λ` を導入して

$$
A=A(a,\lambda),\qquad B=B(b,\lambda)
$$

と書ける（ここまでは標準的な局所モデルと同じ形）。

重要なのは、実験で相関を推定するときに **選別（採否）** が入り、
観測される相関が一般に条件付き平均になる点である：

$$
E_{\mathrm{obs}}(a,b)
=
\mathbb{E}[AB\mid s=1,a,b]
=
\frac{\int d\lambda\;\rho(\lambda)\,w_{ab}(\lambda)\,A(a,\lambda)B(b,\lambda)}
{\int d\lambda\;\rho(\lambda)\,w_{ab}(\lambda)}.
$$

ここで `w_{ab}(\lambda)=\Pr(s=1\mid a,b,\lambda)` が、time-tag の遅延構造などにより (a,b) 依存になり得る。
このとき (a,b) の4通りで **有効な母集団が異なる**ため、CHSH の標準導出（同一母集団平均）が適用できない。

詳細な前提整理と式は `doc/quantum/06_chsh_assumptions_and_selection.md` を参照。

---

## 4. toy（再現可能）で確認する点

Step 7.2 の toy では、

- coincidence window を変えると S(Δt) が変化し得る
- window が十分大きい（事実上、全ペア採用）と trial-based と同じになる

という “観測手続き依存” を固定した。

参照出力：
- `output/quantum/bell_time_tag_selection_sweep.png`
- `output/quantum/bell_time_tag_selection_sweep_metrics.json`

本toyは証拠ではないが、「一次データで何を確認すべきか」を明確にする。

---

## 5. 反証条件（Step 7.4 での判定軸）

この再解釈が成り立つには、少なくとも以下が観測される必要がある。

- S が Δt（同時計数窓）や pairing アルゴリズムに依存して変化する。
- trial-based（パルス番号など）でペア定義したときに、coincidence-based と同じ S が再現できない（または再現するには追加仮定が要る）。

逆に、以下が **安定に成立**するなら、この再解釈は棄却される。

- Δt を広範に変えても S が不変
- trial-based 定義でも S が同一
- time-tag アルゴリズム（閾値・補間・分解能）変更に対して S が安定

---

## 6. 次（Step 7.4）

次は、time-tag を含む一次データ（raw）を選定し、
- S(Δt)
- trial-based vs coincidence-based
- time-tag アルゴリズム依存

を再解析して、上の反証条件で判定する。
一次ソースは `doc/PRIMARY_SOURCES.md` にURL/取得日/ローカル保存先を固定し、raw を `data/quantum/sources/` にキャッシュする。
